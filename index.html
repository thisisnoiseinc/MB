<!DOCTYPE html>
<html>
<link rel="stylesheet" href="../MB/style.css" />
<link rel="icon" href="https://cdn.shopify.com/s/files/1/0521/7284/9345/files/Favicon_d7d0f79f-bd39-4262-aea3-f76f66f726a1.png?v=1664544047" />
<title>MIDI BLASTER Updater</title>
<body>
    <h1 style= "font-family: Avenir; color: white;">MIDI BLASTER UPDATER ðŸ”§</h1>
    <p style= "font-family: Avenir; color: #79DA75;">Latest Version: 1.0.0</p>
    <p style= "font-family: Avenir; color: white;">1. Hold Button 1 on MIDI BLASTER during start-up</p>
    <p style= "font-family: Avenir; color: white;">2. Press "Install" below ðŸ‘‡</p>
    <script type="module" src="https://unpkg.com/esp-web-tools@3.4.2/dist/web/install-button.js?module"></script>
    <esp-web-install-button manifest="test/manifest.json"></esp-web-install-button>
<style>
  :root {
    --esp-tools-button-color: #B51F99;
    --esp-tools-button-text-color: white;
  }
</style>

<button id="resetButton">Reset 1.4</button>

<script>
  const resetButton = document.querySelector('#resetButton');

  async function onResetButtonClick() {
    const port = await navigator.serial.requestPort();
    await port.open({ baudRate: 115200 });

    // Reset sequence
    await port.setSignals({ dataTerminalReady: true });
    await port.setSignals({ requestToSend: true });
    await new Promise((resolve) => setTimeout(resolve, 100));
    await port.setSignals({ requestToSend: false });
    await port.setSignals({ dataTerminalReady: false });
    await new Promise((resolve) => setTimeout(resolve, 100));
    await port.setSignals({ dataTerminalReady: true });
    await port.setSignals({ requestToSend: false });
    await new Promise((resolve) => setTimeout(resolve, 100));
    await port.setSignals({ dataTerminalReady: false });
    await port.setSignals({ requestToSend: true });
  }

  resetButton.addEventListener('click', onResetButtonClick);
</script>
</body>
</html>
